use SECURITY: Strong

# By default deny all unknowns
DENY_READ          = anonymous@*
DENY_WRITE         = anonymous@*
DENY_ADMINISTRATOR = anonymous@*
DENY_DAEMON        = anonymous@*
DENY_NEGOTIATOR    = anonymous@*
DENY_CLIENT        = anonymous@*

# Privacy settings
SEC_CLIENT_INTEGRITY  = REQUIRED
SEC_CLIENT_ENCRYPTION = REQUIRED

SEC_DAEMON_INTEGRITY  = REQUIRED
SEC_DAEMON_ENCRYPTION = REQUIRED

SEC_DEFAULT_INTEGRITY  = REQUIRED
SEC_DEFAULT_ENCRYPTION = REQUIRED

# Set the pool password
SEC_PASSWORD_FILE = /etc/condor/passwords.d/pool_password

# Authentication settings
SEC_CLIENT_AUTHENTICATION  = REQUIRED
SEC_DAEMON_AUTHENTICATION  = REQUIRED
SEC_DEFAULT_AUTHENTICATION = REQUIRED

SEC_CLIENT_AUTHENTICATION_METHODS  = FS, IDTOKENS, PASSWORD
SEC_DAEMON_AUTHENTICATION_METHODS  = IDTOKENS, PASSWORD
SEC_ADVERTISE_MASTER_AUTHENTICATION_METHODS = PASSWORD, IDTOKENS
SEC_ADVERTISE_STARTD_AUTHENTICATION_METHODS = PASSWORD, IDTOKENS

ALLOW_DAEMON = condor_pool@*
COLLECTOR.ALLOW_ADVERTISE_STARTD = worker@cloud
COLLECTOR.ALLOW_ADVERTISE_MASTER = condor_pool@*, worker@cloud
