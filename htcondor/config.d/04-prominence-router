# Routes
JOB_ROUTER_DEFAULTS @=jrd
  [
    MaxIdleJobs = 60;
    MaxJobs = 200;
    delete_ProminenceWantJobRouter = true;
  ]
  @jrd

JOB_ROUTER_ENTRIES @=jre
  [
    TargetUniverse = 5;
    name = "cloud";
    requirements = target.ProminenceWantJobRouter is True;
    set_ProminenceInfrastructureType = "cloud";
    FailureRateThreshold = 10000;
  ]
  @jre

# Enable the job router daemon
DAEMON_LIST = $(DAEMON_LIST), JOB_ROUTER

# How often to poll
JOB_ROUTER_POLLING_PERIOD = 60

# It is good to save lots of schedd queue history for use with the router_history command.
MAX_HISTORY_ROTATIONS = 20

# Job router hooks
JOB_ROUTER_HOOK_KEYWORD = PROMINENCE
PROMINENCE_HOOK_TRANSLATE_JOB = /usr/local/bin/cloud_hook_translate_job.py
PROMINENCE_HOOK_JOB_CLEANUP = /usr/local/bin/cloud_hook_cleanup_job.py
PROMINENCE_HOOK_UPDATE_JOB_INFO = /usr/local/bin/cloud_hook_update_job_info.py

# Copy ClassAd attributes from routed job back to original job
PROMINENCE_ATTRS_TO_COPY = ProminenceInfrastructureType, \
                           ProminenceInfrastructureState, \
                           ProminenceInfrastructureStateReason, \
                           ProminenceInfrastructureEnteredCurrentStatus, \
                           ProminenceInfrastructureSite, \
                           ProminenceInfrastructureId, \
                           ProminenceOutputLocationsUser, \
                           ProminenceOutputDirLocationsUser, \
                           ProminenceImagePullTime, \
                           ProminenceImagePullSuccess, \
                           ProminenceExecuteTime, \
                           ProminenceExitCode, \
                           JobCurrentStartExecutingDate, \
                           LastVacateTime, \
                           EnteredCurrentStatus, \
                           JobFinishedHookDone, \
                           MachineAttrPROMINENCE_CLOUD0
